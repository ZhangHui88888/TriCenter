# æ¨¡å—3ï¼šä¼ä¸šç®¡ç† API æµ‹è¯•è®°å½•

> æµ‹è¯•æ—¥æœŸï¼š2026-02-03
> æµ‹è¯•äººå‘˜ï¼šAI Assistant
> æµ‹è¯•ç¯å¢ƒï¼šå¼€å‘ç¯å¢ƒ (localhost:8080)

---

## API æ¸…å•

| åºå· | API | è·¯å¾„ | è®¤è¯ | çŠ¶æ€ |
|------|-----|------|------|------|
| 3.1 | ä¼ä¸šåˆ—è¡¨ | GET /api/enterprises | ğŸ”’ | âœ… é€šè¿‡ |
| 3.2 | ä¼ä¸šè¯¦æƒ… | GET /api/enterprises/:id | ğŸ”’ | âœ… é€šè¿‡ |
| 3.3 | æ–°å¢ä¼ä¸š | POST /api/enterprises | ğŸ”’ | âœ… é€šè¿‡ |
| 3.4 | ç¼–è¾‘ä¼ä¸š | PUT /api/enterprises/:id | ğŸ”’ | âœ… é€šè¿‡ |
| 3.5 | åˆ é™¤ä¼ä¸š | DELETE /api/enterprises/:id | ğŸ”’ | âœ… é€šè¿‡ |
| 3.6 | å˜æ›´æ¼æ–—é˜¶æ®µ | PATCH /api/enterprises/:id/stage | ğŸ”’ | âœ… é€šè¿‡ |
| 3.7 | æ‰¹é‡å¯¼å…¥ | POST /api/enterprises/import | ğŸ”’ | âœ… é€šè¿‡ |
| 3.8 | å¯¼å‡ºä¼ä¸š | GET /api/enterprises/export | ğŸ”’ | âœ… é€šè¿‡ |
| 3.9 | è·å–å¯¼å…¥æ¨¡æ¿ | GET /api/enterprises/template | ğŸ”’ | âœ… é€šè¿‡ |
| 3.10 | è·å–ä¼ä¸šè·Ÿè¿›è®°å½• | GET /api/enterprises/:id/follow-ups | ğŸ”’ | â³ å¾…å¼€å‘ |
| 3.11 | æ›´æ–°ä¼ä¸šè”ç³»äºº | PUT /api/enterprises/:id/contacts | ğŸ”’ | âœ… é€šè¿‡ |
| 3.12 | ä¼ä¸šæ•°æ®åˆ†æ | GET /api/enterprises/analysis | ğŸ”’ | â³ å¾…å¼€å‘ |

---

## å‰ç½®æ¡ä»¶

æ‰€æœ‰ API éƒ½éœ€è¦å…ˆç™»å½•è·å– Tokenï¼š

```
POST /api/auth/login
Body: { "username": "admin", "password": "admin123" }
Response: { "data": { "token": "xxx" } }
```

---

## 3.1 ä¼ä¸šåˆ—è¡¨

### è¯·æ±‚æ ¼å¼
```
GET /api/enterprises?keyword=&stage=&district=&page=1&pageSize=10
Header: Authorization: Bearer <token>
```

### å“åº”æ ¼å¼
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [...],
    "total": 10,
    "page": 1,
    "pageSize": 10,
    "pages": 1
  }
}
```

### æµ‹è¯•ç”¨ä¾‹

| åœºæ™¯ | å…¥å‚ | é¢„æœŸç»“æœ | å®é™…ç»“æœ | çŠ¶æ€ |
|------|------|----------|----------|------|
| æ­£å¸¸æŸ¥è¯¢ | page=1&pageSize=10 | è¿”å›åˆ—è¡¨ | è¿”å›åˆ—è¡¨ | âœ… |
| å…³é”®è¯æœç´¢ | keyword=Updated | è¿”å›åŒ¹é…è®°å½• | è¿”å›åŒ¹é…è®°å½• | âœ… |
| é˜¶æ®µç­›é€‰ | stage=HAS_DEMAND | è¿”å›è¯¥é˜¶æ®µä¼ä¸š | è¿”å›è¯¥é˜¶æ®µä¼ä¸š | âœ… |
| æ— Token | - | 403 Forbidden | 403 Forbidden | âœ… |

---

## 3.3 æ–°å¢ä¼ä¸š

### åŠŸèƒ½è¯´æ˜
æ”¯æŒä¸¤ç§åˆ›å»ºæ¨¡å¼ï¼š
1. **ç©ºç™½ä¼ä¸šåˆ›å»º**ï¼šä¸ä¼ ä»»ä½•å‚æ•°ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆé»˜è®¤ä¼ä¸šåç§°ï¼ˆæ ¼å¼ï¼š`æ–°å»ºä¼ä¸š_æ—¶é—´æˆ³`ï¼‰
2. **å®Œæ•´ä¿¡æ¯åˆ›å»º**ï¼šä¼ å…¥ä¼ä¸šè¯¦ç»†ä¿¡æ¯

### è¯·æ±‚æ ¼å¼
```
POST /api/enterprises
Header: Authorization: Bearer <token>
Content-Type: application/json

# ç©ºç™½ä¼ä¸šåˆ›å»º
Body: {}

# å®Œæ•´ä¿¡æ¯åˆ›å»º
Body: {
  "name": "ä¼ä¸šåç§°",
  "creditCode": "ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ",
  "province": "æ±Ÿè‹çœ",
  "city": "å¸¸å·å¸‚",
  "district": "æ–°åŒ—åŒº",
  "address": "è¯¦ç»†åœ°å€",
  "industryId": 1,
  "enterpriseType": "ç”Ÿäº§å‹",
  "staffSizeId": 1,
  "domesticRevenueId": 1,
  "crossBorderRevenueId": 1,
  "sourceId": 1,
  "website": "https://example.com",
  "contactName": "è”ç³»äººå§“å",
  "contactPhone": "13800138000",
  "contactPosition": "æ€»ç»ç†"
}
```

### å“åº”æ ¼å¼
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "name": "æ–°å»ºä¼ä¸š_1738564800000",
    "stage": "POTENTIAL",
    ...
  }
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | String | å¦ | ä¼ä¸šåç§°ï¼Œä¸ä¼ åˆ™è‡ªåŠ¨ç”Ÿæˆ |
| creditCode | String | å¦ | ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ï¼Œæœ€å¤š18ä½ |
| province | String | å¦ | çœä»½ |
| city | String | å¦ | åŸå¸‚ |
| district | String | å¦ | åŒºåŸŸ |
| address | String | å¦ | è¯¦ç»†åœ°å€ |
| industryId | Integer | å¦ | è¡Œä¸šID |
| enterpriseType | String | å¦ | ä¼ä¸šç±»å‹ |
| staffSizeId | Integer | å¦ | äººå‘˜è§„æ¨¡ID |
| domesticRevenueId | Integer | å¦ | å›½å†…è¥æ”¶ID |
| crossBorderRevenueId | Integer | å¦ | è·¨å¢ƒè¥æ”¶ID |
| sourceId | Integer | å¦ | æ¥æºID |
| website | String | å¦ | å®˜ç½‘ |
| contactName | String | å¦ | è”ç³»äººå§“å |
| contactPhone | String | å¦ | è”ç³»äººç”µè¯ |
| contactPosition | String | å¦ | è”ç³»äººèŒä½ |

### æµ‹è¯•ç”¨ä¾‹

| åœºæ™¯ | å…¥å‚ | é¢„æœŸç»“æœ | å®é™…ç»“æœ | çŠ¶æ€ |
|------|------|----------|----------|------|
| ç©ºç™½ä¼ä¸šåˆ›å»º | {} | åˆ›å»ºæˆåŠŸï¼Œè¿”å›è‡ªåŠ¨ç”Ÿæˆçš„ä¼ä¸šåç§° | åˆ›å»ºæˆåŠŸ | âœ… |
| å®Œæ•´ä¿¡æ¯åˆ›å»º | å®Œæ•´æ•°æ® | åˆ›å»ºæˆåŠŸ | åˆ›å»ºæˆåŠŸ | âœ… |
| ä»…ä¼ä¸šåç§° | {"name":"æµ‹è¯•ä¼ä¸š"} | åˆ›å»ºæˆåŠŸ | åˆ›å»ºæˆåŠŸ | âœ… |
| é‡å¤ä¼ä¸šåç§° | å·²å­˜åœ¨çš„åç§° | 400 é”™è¯¯ | 400 é”™è¯¯ | âœ… |
| ä¼ä¸šåç§°è¶…é•¿ | nameè¶…è¿‡200å­—ç¬¦ | 400 é”™è¯¯ | 400 é”™è¯¯ | âœ… |
| ç‰¹æ®Šå­—ç¬¦ | nameå«<script> | åˆ›å»ºæˆåŠŸï¼ˆå­˜å‚¨åŸå€¼ï¼‰ | åˆ›å»ºæˆåŠŸ | âœ… |
| å¸¦è”ç³»äººåˆ›å»º | name+contactName+contactPhone | åˆ›å»ºæˆåŠŸï¼ŒåŒæ—¶åˆ›å»ºè”ç³»äºº | åˆ›å»ºæˆåŠŸ | âœ… |
| ä»…è”ç³»äººæ— ç”µè¯ | contactNameæœ‰å€¼ï¼ŒcontactPhoneä¸ºç©º | åˆ›å»ºæˆåŠŸï¼Œä¸åˆ›å»ºè”ç³»äºº | åˆ›å»ºæˆåŠŸ | âœ… |
| æ— Token | - | 403 Forbidden | 403 Forbidden | âœ… |

---

## 3.5 åˆ é™¤ä¼ä¸š

### æµ‹è¯•ç”¨ä¾‹

| åœºæ™¯ | å…¥å‚ | é¢„æœŸç»“æœ | å®é™…ç»“æœ | çŠ¶æ€ |
|------|------|----------|----------|------|
| æ­£å¸¸åˆ é™¤ | å­˜åœ¨çš„ID | åˆ é™¤æˆåŠŸ | åˆ é™¤æˆåŠŸ | âœ… |
| å·²åˆ é™¤ä¼ä¸š | å·²åˆ é™¤çš„ID | 404 é”™è¯¯ | 404 é”™è¯¯ | âœ… |
| ä¸å­˜åœ¨ID | 99999 | 404 é”™è¯¯ | 404 é”™è¯¯ | âœ… |

---

## 3.6 å˜æ›´æ¼æ–—é˜¶æ®µ

### è¯·æ±‚æ ¼å¼
```
PATCH /api/enterprises/:id/stage
Body: { "stage": "HAS_DEMAND", "reason": "å˜æ›´åŸå› " }
```

### æµ‹è¯•ç”¨ä¾‹

| åœºæ™¯ | å…¥å‚ | é¢„æœŸç»“æœ | å®é™…ç»“æœ | çŠ¶æ€ |
|------|------|----------|----------|------|
| æ­£å¸¸å˜æ›´ | stage=HAS_DEMAND | å˜æ›´æˆåŠŸ | å˜æ›´æˆåŠŸ | âœ… |
| ç›¸åŒé˜¶æ®µ | å½“å‰é˜¶æ®µ | 400 é”™è¯¯ | 400 é”™è¯¯ | âœ… |
| ç©ºé˜¶æ®µ | stage="" | 400 é”™è¯¯ | 400 é”™è¯¯ | âœ… |

---

## 3.7-3.9 å¯¼å…¥å¯¼å‡º

### æµ‹è¯•ç»“æœ

| åŠŸèƒ½ | æµ‹è¯•ç»“æœ | çŠ¶æ€ |
|------|----------|------|
| ä¸‹è½½å¯¼å…¥æ¨¡æ¿ | æˆåŠŸä¸‹è½½ xlsx æ–‡ä»¶ | âœ… |
| å¯¼å‡ºä¼ä¸šåˆ—è¡¨ | æˆåŠŸå¯¼å‡º xlsx æ–‡ä»¶ | âœ… |
| æ‰¹é‡å¯¼å…¥ | åŠŸèƒ½å¯ç”¨ | âœ… |

---

## æµ‹è¯•æ±‡æ€»

- **æµ‹è¯•è„šæœ¬**: `backend/test-module3-enterprise.ps1`
- **æ€»æµ‹è¯•æ•°**: 30
- **é€šè¿‡æ•°**: 30
- **å¤±è´¥æ•°**: 0
- **é€šè¿‡ç‡**: 100%

---

## é—®é¢˜è®°å½•

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ | çŠ¶æ€ |
|------|------|----------|------|
| ç©ºç™½ä¼ä¸šåˆ›å»ºå¤±è´¥ | æ•°æ®åº“å­—æ®µ districtã€enterprise_type ä¸å…è®¸ä¸ºç©º | åœ¨æœåŠ¡å±‚æ·»åŠ é»˜è®¤å€¼ | âœ… å·²ä¿®å¤ |

---

*æ–‡æ¡£æ›´æ–°æ—¶é—´ï¼š2026-02-03*
