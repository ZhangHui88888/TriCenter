# 数据库设计文档

> 常州跨境电商三中心 - 企业信息管理系统

---

## 数据库选型

- **推荐**: MySQL 8.0+ 或 PostgreSQL 14+
- **字符集**: UTF-8 (utf8mb4)
- **排序规则**: utf8mb4_unicode_ci

---

## 文件结构

| 文件 | 说明 |
|------|------|
| `sql/01_create_tables.sql` | 建表语句 |
| `sql/02_init_system_options.sql` | 系统选项配置数据 |
| `sql/03_init_industry.sql` | 行业分类数据 |
| `sql/04_init_product_category.sql` | 产品品类数据 |
| `sql/05_init_requirements.sql` | 需求初始化数据 |

> **注**: 销售目标国（country）数据由前端硬编码管理，详见 `frontend/src/data/countries.ts`

---

## 表结构概览

| 序号 | 表名 | 说明 | 状态 |
|------|------|------|------|
| 1 | users | 用户表 | ⬜ 待创建 |
| 2 | industry_categories | 行业分类表 | ⬜ 待创建 |
| 3 | product_categories | 产品品类分类表 | ⬜ 待创建 |
| 4 | system_options | 系统选项配置 | ⬜ 待创建 |
| 5 | enterprises | 企业主表 | ⬜ 待创建 |
| 6 | enterprise_contacts | 企业联系人 | ⬜ 待创建 |
| 7 | enterprise_products | 企业产品 | ⬜ 待创建 |
| 8 | enterprise_patents | 专利信息 | ⬜ 待创建 |
| 9 | follow_up_records | 跟进记录 | ⬜ 待创建 |
| 10 | stage_change_logs | 阶段变更日志 | ⬜ 待创建 |
| 11 | requirements | 需求主表 | ⬜ 待创建 |
| 12 | requirement_dimension_mapping | 需求维度映射表 | ⬜ 待创建 |
| 13 | enterprise_requirements | 企业需求关联表 | ⬜ 待创建 |
| 14 | enterprise_dimension_selections | 企业维度选择表 | ⬜ 待创建 |

> **注**: 竞争对手(enterprise_competitors)和风险信息(enterprise_risks)表暂不开发，前端使用Mock数据

---

## 表结构详情

### 表1: users (用户表)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| username | VARCHAR(50) | 用户名 |
| password | VARCHAR(255) | 密码(加密) |
| name | VARCHAR(50) | 姓名 |
| role | ENUM | 角色: admin/manager/user |
| phone | VARCHAR(20) | 手机号 |
| email | VARCHAR(100) | 邮箱 |
| status | TINYINT | 状态: 1启用 0禁用 |
| last_login_at | DATETIME | 最后登录时间 |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

---

### 表2: industry_categories (行业分类表)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| parent_id | INT | 父级ID，0为顶级 |
| name | VARCHAR(50) | 分类名称 |
| level | TINYINT | 层级：1/2/3 |
| path | VARCHAR(100) | 完整路径，如：1/5/12 |
| sort_order | INT | 排序 |
| is_enabled | TINYINT | 是否启用 |
| created_at | DATETIME | 创建时间 |

---

### 表3: product_categories (产品品类分类表)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| parent_id | INT | 父级ID，0为顶级 |
| name | VARCHAR(50) | 品类名称 |
| level | TINYINT | 层级：1/2/3 |
| path | VARCHAR(100) | 完整路径 |
| sort_order | INT | 排序 |
| is_enabled | TINYINT | 是否启用 |
| created_at | DATETIME | 创建时间 |

---

### 表4: system_options (系统选项配置表)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| category | VARCHAR(50) | 分类 |
| value | VARCHAR(50) | 选项值 |
| label | VARCHAR(100) | 显示名称 |
| color | VARCHAR(20) | 颜色(用于标签) |
| sort_order | INT | 排序 |
| is_enabled | TINYINT | 是否启用 |
| created_at | DATETIME | 创建时间 |

#### 数据字典分类说明

| category | 说明 | 使用位置 |
|----------|------|----------|
| stage | 漏斗阶段 | 企业主表.stage |
| district | 区域 | 企业主表.district |
| staff_size | 人员规模 | 企业主表.staff_size_id |
| revenue | 营收规模 | 企业主表.domestic_revenue_id, cross_border_revenue_id |
| source | 企业来源 | 企业主表.source_id |
| enterprise_type | 企业类型 | 企业主表.enterprise_type |
| trade_mode | 外贸模式 | 企业主表.trade_mode_id |
| trade_team_mode | 外贸业务团队模式 | 企业主表.trade_team_mode_id |
| trade_business_mode | 外贸业务模式 | 企业主表.mode_changes |
| region | 销售区域 | 企业主表.target_region_ids |
| certification | 产品认证 | 企业产品.certification_ids |
| automation_level | 自动化程度 | 企业产品.automation_level_id |
| logistics | 物流合作方 | 企业产品.logistics_partner_ids |
| growth_reason | 增长原因 | 企业主表.growth_reasons |
| decline_reason | 下降原因 | 企业主表.decline_reasons |
| cross_border_platform | 跨境平台 | 企业主表.cross_border_platforms |
| cross_border_logistics | 跨境物流模式 | 企业主表.cross_border_logistics |
| payment_settlement | 支付结算方式 | 企业主表.payment_settlement |
| enjoyed_policy | 已享受政策 | 企业主表.enjoyed_policies |
| tricenter_project | 三中心合作项目 | 企业主表.tricenter_demands |
| cooperation_concern | 不合作顾虑 | 企业主表.tricenter_concerns |
| follow_type | 跟进类型 | 跟进记录.follow_type |
| requirement_phase | 需求阶段 | 需求主表.phase |
| requirement_category | 需求分类 | 需求主表.category |

---

### 表5: enterprises (企业主表)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| name | VARCHAR(200) | 企业名称 |
| credit_code | VARCHAR(18) | 统一社会信用代码 |
| province | VARCHAR(20) | 省 |
| city | VARCHAR(20) | 市 |
| district | VARCHAR(20) | 区(所属区域) |
| address | VARCHAR(500) | 详细地址 |
| industry_id | INT | 行业分类ID |
| enterprise_type | VARCHAR(20) | 企业类型 |
| staff_size_id | INT | 人员规模ID |
| website | VARCHAR(200) | 官网 |
| domestic_revenue_id | INT | 国内营收ID |
| cross_border_revenue_id | INT | 跨境营收ID |
| source_id | INT | 企业来源ID |
| stage | VARCHAR(20) | 漏斗阶段 |
| has_own_brand | TINYINT | 是否有自主品牌 |
| brand_names | VARCHAR(500) | 品牌名称列表 |
| target_region_ids | JSON | 主要销售区域ID数组 |
| target_country_ids | JSON | 主要销售国家代码数组 |
| trade_mode_id | INT | 外贸模式ID |
| has_import_export_license | TINYINT | 是否有进出口资质 |
| customs_declaration_mode | VARCHAR(20) | 报关申报主体模式 |
| trade_team_mode_id | INT | 外贸业务团队模式ID |
| trade_team_size | INT | 外贸团队人数 |
| has_domestic_ecommerce | TINYINT | 是否有国内电商经验 |
| last_year_revenue | DECIMAL(12,2) | 上年外贸营业额(万元) |
| year_before_last_revenue | DECIMAL(12,2) | 上上年外贸营业额(万元) |
| market_changes | JSON | 市场变化 |
| mode_changes | JSON | 模式变化 |
| category_changes | JSON | 品类变化 |
| growth_reasons | JSON | 增长原因ID数组 |
| decline_reasons | JSON | 下降原因ID数组 |
| has_cross_border | TINYINT | 是否开展跨境电商 |
| cross_border_ratio | VARCHAR(20) | 跨境业务占比 |
| cross_border_logistics | VARCHAR(100) | 跨境物流模式ID |
| payment_settlement | VARCHAR(100) | 支付结算方式ID |
| cross_border_team_size | INT | 跨境电商团队规模 |
| using_erp | TINYINT | 是否在用ERP |
| transformation_willingness | VARCHAR(20) | 跨境转型意愿 |
| investment_willingness | VARCHAR(20) | 愿意投入转型程度 |
| cross_border_platforms | JSON | 跨境平台ID数组 |
| target_markets | JSON | 目标市场及占比 |
| service_cooperation_rating | TINYINT | 企业服务合作可能性(1-5星) |
| investment_cooperation_rating | TINYINT | 招商入驻合作可能性(1-5星) |
| incubation_cooperation_rating | TINYINT | 孵化转型合作可能性(1-5星) |
| brand_cooperation_rating | TINYINT | 品牌营销合作可能性(1-5星) |
| training_cooperation_rating | TINYINT | 人才培训合作可能性(1-5星) |
| overall_cooperation_rating | TINYINT | 跨境整体方案合作可能性(1-5星) |
| benchmark_possibility | INT | 标杆企业可能性百分比 |
| additional_notes | TEXT | 其它补充说明 |
| has_policy_support | TINYINT | 是否享受过政策支持 |
| enjoyed_policies | JSON | 已享受政策列表 |
| desired_support | JSON | 希望获得的支持 |
| cooperation_demands | JSON | 合作需求 |
| competition_position | VARCHAR(50) | 行业竞争地位 |
| competition_description | TEXT | 竞争地位描述 |
| pain_points | TEXT | 跨境业务痛点 |
| tricenter_demands | JSON | 与三中心合作主要需求 |
| tricenter_concerns | TEXT | 不考虑合作主要顾虑 |
| is_deleted | TINYINT | 是否删除 |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

---

### 表6: enterprise_contacts (企业联系人)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| enterprise_id | INT | 企业ID |
| name | VARCHAR(50) | 联系人姓名 |
| phone | VARCHAR(20) | 联系电话 |
| position | VARCHAR(50) | 职位 |
| is_primary | TINYINT | 是否主要联系人 |
| email | VARCHAR(100) | 邮箱 |
| wechat | VARCHAR(50) | 微信 |
| remark | VARCHAR(500) | 备注 |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

---

### 表7: enterprise_products (企业产品)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| enterprise_id | INT | 企业ID |
| name | VARCHAR(200) | 产品名称 |
| category_id | INT | 产品品类ID |
| certification_ids | JSON | 认证标签ID数组 |
| target_region_ids | JSON | 主要销售区域ID数组 |
| target_country_ids | JSON | 主要销售国家代码数组 |
| annual_sales | VARCHAR(50) | 年销售额 |
| local_procurement_ratio | VARCHAR(20) | 原材料本地采购比例 |
| automation_level_id | INT | 装备自动化程度ID |
| annual_capacity | VARCHAR(50) | 年产能 |
| logistics_partner_ids | JSON | 物流合作方ID数组 |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

---

### 表8: enterprise_patents (专利信息)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| enterprise_id | INT | 企业ID |
| name | VARCHAR(200) | 专利名称 |
| patent_no | VARCHAR(50) | 专利号 |
| created_at | DATETIME | 创建时间 |

---

### 表9: follow_up_records (跟进记录)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| enterprise_id | INT | 企业ID |
| follow_type | VARCHAR(20) | 跟进类型 |
| follow_date | DATE | 跟进日期 |
| content | TEXT | 跟进内容 |
| status | VARCHAR(50) | 整体状态 |
| next_plan | VARCHAR(500) | 下一步计划 |
| stage_from | VARCHAR(20) | 变更前阶段 |
| stage_to | VARCHAR(20) | 变更后阶段 |
| follower_id | INT | 跟进人ID |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

---

### 表10: stage_change_logs (阶段变更日志)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| enterprise_id | INT | 企业ID |
| stage_from | VARCHAR(20) | 变更前阶段 |
| stage_to | VARCHAR(20) | 变更后阶段 |
| reason | VARCHAR(500) | 变更原因 |
| operator_id | INT | 操作人ID |
| follow_up_id | INT | 关联跟进记录ID |
| created_at | DATETIME | 创建时间 |

---

### 表11: requirements (需求主表)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | VARCHAR(20) | 主键，如1.1.1 |
| name | VARCHAR(100) | 需求名称 |
| description | VARCHAR(500) | 需求简述 |
| detail_description | TEXT | 需求详细描述 |
| phase | VARCHAR(50) | 所属阶段 |
| category | VARCHAR(50) | 所属分类 |
| is_universal | TINYINT | 是否通用必选 |
| is_enhanced | TINYINT | 是否增强项 |
| is_custom | TINYINT | 是否自定义需求 |
| enterprise_id | INT | 所属企业ID |
| sort_order | INT | 排序 |
| is_enabled | TINYINT | 是否启用 |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

---

### 表12: requirement_dimension_mapping (需求维度映射表)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| requirement_id | VARCHAR(20) | 需求ID |
| dimension_key | VARCHAR(50) | 维度键 |
| dimension_value | VARCHAR(50) | 维度值 |
| created_at | DATETIME | 创建时间 |

---

### 表13: enterprise_requirements (企业需求关联表)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| enterprise_id | INT | 企业ID |
| requirement_id | VARCHAR(20) | 需求ID |
| source | VARCHAR(50) | 需求来源 |
| status | VARCHAR(20) | 状态 |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

---

### 表14: enterprise_dimension_selections (企业维度选择表)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键 |
| enterprise_id | INT | 企业ID |
| dimension_key | VARCHAR(50) | 维度键 |
| dimension_value | VARCHAR(50) | 维度值 |
| created_at | DATETIME | 创建时间 |
